# SAMJIN Network Monitoring - ì‹œìŠ¤í…œ ìš´ì˜ ë° ì‚¬ìš©ì ë§¤ë‰´ì–¼ (User Operation Manual)

ì´ ë¬¸ì„œëŠ” ëª¨ë‹ˆí„°ë§ ì¸í”„ë¼ êµ¬ì¶• ë° ê°€ë™ ì´í›„, ì‹¤ì œ ìš´ì˜ì(Admin/Viewer)ê°€ ì„œë¹„ìŠ¤ë¥¼ ì–´ë–»ê²Œ ë‹¤ë¤„ì•¼ í•˜ëŠ”ì§€ì— ê´€í•œ **ìœ ì§€ë³´ìˆ˜ ê°€ì´ë“œë¼ì¸ ë° í”Œë«í¼ ì‚¬ìš© ì„¤ëª…ì„œ**ì…ë‹ˆë‹¤.

---

## 1. ìš´ì˜ í¬íŠ¸ ë° ì ‘ì† ì •ë³´

ì—”í„°í”„ë¼ì´ì¦ˆ ì‚¬ë‚´ ë§ ì •ì±…ì— ë”°ë¼, `kr-netmon-frontend` ë„ì»¤ ë„¤íŠ¸ì›Œí¬ë¥¼ ê²½ìœ í•´ ì•„ë˜ì˜ ë‘ ê°€ì§€ UI ì§„ì…ì ì„ í†µí•´ ì‹œìŠ¤í…œì— ì ‘ê·¼í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### 1.1 í”Œë«í¼ ì§„ì… ê²½ë¡œ
*   **Zabbix Admin Console (ê´€ë¦¬ì ë° ì¥ë¹„ ë“±ë¡ ì „ìš©)**
    *   **URL:** `http://[í˜¸ìŠ¤íŠ¸ IP ë˜ëŠ” ë„ë©”ì¸]:8081`
    *   **ê¸°ë³¸ ID:** `Admin` (ëŒ€ë¬¸ì A ìœ ì˜)
    *   **ê¸°ë³¸ PW:** `zabbix` (ì£¼ì˜: ìµœì´ˆ ë¡œê·¸ì¸ ì¦‰ì‹œ í”„ë¡œí•„ì—ì„œ PW ë³€ê²½ í•„ìˆ˜)
*   **Grafana Dashboard (ì „ì‚° í˜„í™©íŒ, ê²½ì˜ì§„ ë³´ê³  ë° íƒ€ ë¶€ì„œ ì‹¤ì‹œê°„ ê°€ì‹œì„±)**
    *   **URL:** `http://[í˜¸ìŠ¤íŠ¸ IP ë˜ëŠ” ë„ë©”ì¸]:3001`
    *   **ê¸°ë³¸ ID:** `admin`
    *   **ê¸°ë³¸ PW:** `.env`ì—ì„œ ì„¤ì •í•œ `${KR_NETMON_GRAFANA_PASSWORD}` ê°’ ì…ë ¥.

---

## 2. ëª¨ë‹ˆí„°ë§ ê´€ë¦¬ ë° ì‹ ê·œ ì¥ë¹„ ì—°ë™ ì ˆì°¨

ìƒˆë¡œìš´ ë¼ìš°í„°, ìŠ¤ìœ„ì¹˜ ë“± ë„¤íŠ¸ì›Œí¬ ì¸í”„ë¼ êµì²´ ë˜ëŠ” ë„ì… ì‹œ ê°€ì¥ ë¨¼ì € Zabbix ìª½ì— í•´ë‹¹ ê¸°ê¸°ë¥¼ ë“±ë¡í•´ì•¼ë§Œ ì „ì²´ ìŠ¤ì¼€ì¤„ëŸ¬ê°€ í™œì„±í™”ë˜ì–´ ë°ì´í„°ë¥¼ ë‹¹ê²¨ì˜µë‹ˆë‹¤(Polling).

### ë‹¨ê³„ 1: ëŒ€ìƒ ê¸°ê¸°(ìŠ¤ìœ„ì¹˜/ë°©í™”ë²½ ë“±)ì˜ SNMP ìˆ˜ì§‘ í—ˆìš©
- **ìŠ¤ìœ„ì¹˜ ì½˜ì†” ì ‘ì† í›„ ì •ì±… í—ˆìš© ìš”ë§:** Zabbix/Prometheusê°€ ì„¤ì¹˜ëœ ëª¨ë‹ˆí„°ë§ ì„œë²„ IPê°€ ìŠ¤ìœ„ì¹˜ì˜ ì½ê¸° ì „ìš©(Read-only) SNMP Community í†µì‹ ì„ í•  ìˆ˜ ìˆë„ë¡ ë°©í™”ë²½(ACL) ì˜¤í”ˆ í•„ìš”.

### ë‹¨ê³„ 2: Zabbix Console ë‚´ ì¥ë¹„ ë“±ë¡
1. Zabbix Web(`í¬íŠ¸ 8081`) ë¡œê·¸ì¸.
2. ì¢Œì¸¡ ë©”ë‰´ì—ì„œ **`Data collection` > `Hosts`** ì´ë™ í›„ ìš°ì¸¡ ìƒë‹¨ **`Create host`** ë²„íŠ¼ í´ë¦­.
3. ì†ì„± ê°’ ë¶€ì—¬:
   - **Host Name:** ì¡°ì§ í‘œì¤€ ë„¤ì´ë°ì— ë§ëŠ” í˜¸ìŠ¤íŠ¸ëª… (`SW-SEOUL-L3-01` ë“±) ê¸°ì¬.
   - **Templates:** `Network Generic Device by SNMP` ë˜ëŠ” `Cisco IOS by SNMP` ë“± íƒ€ê²Ÿ ê¸°ì¢…ì— ë§ëŠ” ì¸ì¦ëœ ê³µì‹ í…œí”Œë¦¿ ê²€ìƒ‰ í›„ ë§í¬ ì²˜ë¦¬. (ì§ì ‘ ì•„ì´í…œì„ ë§Œë“¤ì§€ ì•Šê³  í…œí”Œë¦¿ ì‚¬ìš©ì„ ê¶Œê³ í•¨).
   - **Host Groups:** ë„¤íŠ¸ì›Œí¬ ë¶„ë¥˜ì— ë§ëŠ” ê·¸ë£¹ ì§€ì • (`KR_Network_Switches` ê·¸ë£¹ ìƒì„± ê¶Œì¥).
   - **Interfaces:** `Add` ë²„íŠ¼ í´ë¦­ > `SNMP` ì„ íƒ. íƒ€ê²Ÿ ìŠ¤ìœ„ì¹˜ IP ë° í¬íŠ¸ 161 (ê¸°ë³¸ê°’) ê¸°ì¬.
   - **Macros (ìƒë‹¨ íƒ­):** `{$SNMP_COMMUNITY}` ë³€ìˆ˜ë¥¼ ë„£ê³ , ìŠ¤ìœ„ì¹˜ì— ì„¸íŒ…ëœ ì»¤ë®¤ë‹ˆí‹° ë¬¸ìì—´(ì˜ˆ: `public`) ê°’ ì…ë ¥ í›„ `Add` (ì €ì¥).

### ë‹¨ê³„ 3: ì„±ëŠ¥ ë©”íŠ¸ë¦­ ì •ìƒ ì¡°íšŒ í™•ì¸ (Observability Standard Check)
- ì¥ë¹„ ë“±ë¡ ì•½ 5ë¶„ ì†Œìš” í›„ ì¢Œì¸¡ ë©”ë‰´ **`Monitoring` > `Latest Data`** í´ë¦­.
- `Hosts` í•„í„°ì— í•´ë‹¹ ì¥ë¹„ëª… ì…ë ¥ í™•ì¸. In/Out ì¸í„°í˜ì´ìŠ¤ ëŒ€ì—­í­ ë“±ì— íŒŒë€ìƒ‰/ë…¹ìƒ‰ ë§‰ëŒ€ê°€ ìˆ˜ì§‘ë˜ê³  ìˆë‹¤ë©´ í†µì‹  ì„±ê³µ ìƒíƒœì„.

---

## 3. ì¥ì• (ì•ŒëŒ) ëŒ€ì‘ ì—…ë¬´ íë¦„

### ì•ŒëŒ ë°œìƒ íŠ¸ë¦¬ê±°(Trigger) ë° ë§¤ì²´
ì‹œìŠ¤í…œì€ Zabbix ì—ì„œ í‰ê°€í•œ ì¡°ê±´ ì„ê³„ì¹˜(ì˜ˆ: Switch Port Error ë°œìƒìœ¨ ìƒìŠ¹, CPU 80% ì ìœ ) ì´ˆê³¼ ì‹œ ì¦‰ê°ì ìœ¼ë¡œ ìƒíƒœë¥¼ ë³€ê²½í•˜ê³  ì•Œë¦¼ì„ ë¸Œë¡œë“œìºìŠ¤íŒ…í•©ë‹ˆë‹¤.
- **í…”ë ˆê·¸ë¨ ì•Œë¦¼ (KR_NETMON_TELEGRAM_WH ì—°ë™ ì±„ë„)**
  - ì•ŒëŒì—ëŠ” `ğŸ”¥ Disaster(ì¬ë‚œ)`, `ğŸ”´ High(ì‹¬ê°)`, `âš ï¸ Warning(ê²½ê³ )`ì™€ ê°™ì€ ì‹¬ê°ë„ ë©”íƒ€ë°ì´í„°ê°€ ë‹´ê²¨ ì „ì†¡.
  - ê´€ë ¨ ë‹´ë‹¹ìëŠ” ë©”ì‹œì§€ ë‚´ Zabbix ë§í¬ë¥¼ í´ë¦­í•˜ì—¬ ì¦‰ì‹œ ëŒ€ì‹œë³´ë“œ ì ‘ê·¼ ë° ë¬¸ì œ ì¡°ì¹˜ ì°©ìˆ˜ ê°€ëŠ¥.

### ì•ŒëŒ í™•ì¸ ì¡°ì¹˜(Acknowledge) ì²˜ë¦¬ ê·œì¹™
ì‹¤ì œ ë‹´ë‹¹ìê°€ ì•ŒëŒì„ ì¸ì§€í–ˆìŒì„ ì‹œìŠ¤í…œì— ë§ˆí‚¹í•´ì•¼ "ì§„í–‰ ì¤‘(In Progress)"ì¸ ì¥ì• ë¡œ ê°„ì£¼í•˜ì—¬ ì˜¤íƒì§€ë¥¼ ì œê±°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
1. Zabbix **`Monitoring` > `Problems`** ì´ë™.
2. í™œì„±í™”ëœ ì´ë²¤íŠ¸ ë‚´ `Ack(ì¸ì§€)` ì¹¼ëŸ¼ í•­ëª© í´ë¦­.
3. "ë„¤íŠ¸ì›Œí¬ ì¼€ì´ë¸” ì¦ì„¤ ì‘ì—…ì— ë”°ë¥¸ ì¼ì‹œì  í¬íŠ¸ ë‹¤ìš´ìœ¼ë¡œ í™•ì¸. ì•½ 30ë¶„ ë‚´ ìë™ ë³µêµ¬ ì˜ˆì •"ê³¼ ê°™ì´ **ì½”ë©˜íŠ¸ ë‚¨ê¸°ê¸° í›„ Acknowledge ë²„íŠ¼ ì œì¶œ**.

---

## 4. ì»¤ìŠ¤í…€ Grafana í™”ë©´ ì¡°ì‘ ê°€ì´ë“œ (UI/UX Token Rule)

Zabbix Console ì´ ì•„ë‹Œ ì‚¬ìš©ì ì¹œí™”í˜• Grafana ë·°ì‰ ì½˜ì†”(í¬íŠ¸ 3001)ì— ê´€í•œ í™œìš©ì…ë‹ˆë‹¤. í™”ë©´ ì»¤ìŠ¤í„°ë§ˆì´ì§• í—ˆìš© ë²”ìœ„ë¥¼ ê°€ì´ë“œë¼ì¸ì— ë§ì¶¥ë‹ˆë‹¤.

1. **í”ŒëŸ¬ê·¸ì¸ ë°ì´í„°ì†ŒìŠ¤ ê²°ì†:**
   - ì²˜ìŒ ì§„ì… í›„ `Configuration > Data Sources` ë©”ë‰´ì—ì„œ, `Zabbix` í˜•íƒœì˜ í”ŒëŸ¬ê·¸ì¸ì´ APIë¥¼ ì‚¬ìš©í•´ ë°ì´í„°ë¥¼ ì£¼ê³ ë°›ëŠ”ì§€(Zabbix URL: `http://kr-netmon-zabbix-web:8080/api_jsonrpc.php`) ì—°ê²° ìƒíƒœ í…ŒìŠ¤íŠ¸ ìˆ˜í–‰.
2. **ì‹ ê·œ ëŒ€ì‹œë³´ë“œ ìƒì„± ì œí•œ ê¶Œê³  (ê·œì¹™ 5.1 ì¤€ìˆ˜):**
   - ê°œë°œ ë° ì¡°ì§ì˜ í”Œë«í¼ í‘œì¤€ ë””ìì¸ì„ ìœ ì§€í•˜ê¸° ìœ„í•˜ì—¬, ì™„ì „íˆ ë™ë–¨ì–´ì§„ ê·¸ë˜í”½ í°íŠ¸ë‚˜ ì•Œë¡ë‹¬ë¡í•œ ì»¤ìŠ¤í…€ ìœ„ì ¯ ë“±ì€ ìƒì„±ì„ ê¸ˆì§€í•©ë‹ˆë‹¤(ì ‘ê·¼ì„± ê¸°ì¤€ ì €í•˜ ìš”ì¸).
   - `KR_NETMON_` í”„ë¦¬í”½ìŠ¤ê°€ ë¶™ì€ ê´€ë¦¬ ëŒ€ì‹œë³´ë“œ í…œí”Œë¦¿ì„ ë³µì œ(Clone)í•˜ì—¬ ì¸í„°í˜ì´ìŠ¤ ë¶€ë¶„ë§Œ ë°”ê¿” ì‚¬ìš©í•˜ëŠ” ê²ƒì„ ê¶Œê³ í•©ë‹ˆë‹¤.
3. **Zabbix Plugin í™”ë©´ ì‚¬ìš©:**
   - ëŒ€ì‹œë³´ë“œ íŒ¨ë„ ì¶”ê°€ ì‹œ, Data Source í•­ëª©ì„ `Zabbix`ë¡œ ì„ íƒ, ê·¸ë£¹/í˜¸ìŠ¤íŠ¸/ì•„ì´í…œ ë¶„ë¥˜ë¡œ ë‚´ë ¤ê°€ë©´ì„œ ìœ„ì ¯ì´ ì‹¤ì‹œê°„ íŒ¨ì¹˜ë˜ëŠ”ì§€ ê²€ì‚¬ ê°€ëŠ¥í•©ë‹ˆë‹¤.

---

## 5. ê¸´ê¸‰ ë°±ë„ì–´ ë° ìœ ì§€ë³´ìˆ˜ ì¡°ì¹˜ (Runbook)

### 5.1 Fail-Safe & Plan-B ë¹„ìƒ ì¡°ì¹˜ (Kill Switch)
ë§Œì•½ Zabbix ìˆ˜ì§‘ í”„ë¡œì„¸ìŠ¤ê°€ ë„¤íŠ¸ì›Œí¬ ëª¨ë‹ˆí„°ë§ ì¥ë¹„ë‚˜ ë¡œì»¬ ë³¼ë¥¨ ìºì‹œì— ìŠ¤íŒŒì´í¬ì„± ê³¼ë¶€í•˜ë¥¼ ì¤˜ì„œ ì½”ì–´ ì„œë¹„ìŠ¤ê°€ ëŠë ¤ì§„ë‹¤ë©´, ì¦‰ì‹œ í´ë§ ìˆ˜ì§‘ ìŠ¤ì¼€ì¤„ëŸ¬ë¥¼ ì°¨ë‹¨í•˜ëŠ” "ê¸´ê¸‰ Kill Switch" ê°€ ì‘ë™í•´ì•¼ í•©ë‹ˆë‹¤.
```bash
# ì „ì²´ëŠ” ê·¸ëŒ€ë¡œ ë‘” ì±„ Zabbix ì½”ì–´ í”„ë¡œì„¸ìŠ¤(ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ëŠ” í–‰ìœ„)ë§Œ Stop
podman stop kr-netmon-zabbix-server
```
ì´ ì¡°ì‘ í›„ì—ë„ ë°ì´í„°ë² ì´ìŠ¤ì˜ ë°ì´í„°ëŠ” íŒŒì†ë˜ì§€ ì•Šìœ¼ë©° Grafana ì—­ì‹œ ì´ì „ì— ìˆ˜ì§‘í•œ ì´ë ¥ì„ ì¡°íšŒ ê°€ëŠ¥í•©ë‹ˆë‹¤ (ì•ˆì „ ë¶„ì‚°í˜• ê²©ë¦¬).

### 5.2 ë°±ì—…(Backup) ì ˆì°¨
ì›” 1íšŒ ì˜êµ¬ ë³´ì¡´ìš© ìŠ¤ëƒ…ìƒ· ì²˜ë¦¬ ë°©ë²•ì…ë‹ˆë‹¤ (ê°€ìš©ì„± í™•ë³´).
```bash
podman exec -it kr-netmon-zabbix-db pg_dumpall -c -U zabbix > zabbix_backup_$(date +%Y%m%d).sql
# ë§Œì¼ ë³µì›ì´ í•„ìš”í•  ë•
# cat zabbix_backup_YYYYMMDD.sql | podman exec -i kr-netmon-zabbix-db psql -U zabbix
```
